{% extends ../base.html %}

{% block title %}
物理设备事件
{% end %}

{% block extra_head %}
	<script type="text/javascript">
		$(document).ready(function(){
			$("#alerts_menu").attr({"class": "active", "style": "margin-left: -2px;"});
			
			var limit = "{{ limit }}";
			var page_size = $("#page_size option");
			for (var i=0; i<page_size.length; i++) {
				if (page_size[i].value == limit) {
					page_size[i].selected = true;
				}
			}
			
			$("#page_size").change(function() {
				var page_size_selected = $("#page_size option:selected");
				var page_size_val = page_size_selected.val();
				window.location.href = document.location.origin + document.location.pathname + "?limit=" + page_size_val;
			});
		});
	</script>
<script src="/static/wisemonitor_phy.js"></script>
{% end %}

{% block main_content %}
<div>
    <ul class="breadcrumb">
        <li>
            <a href="#">系统</a> <span class="divider">/</span>
        </li>
        <li>
            <a href="#">报警</a><span class="divider">/</span>
        </li>
        <li>
            <a href="/system/alerts/physical_device/">物理设备</a>
        </li>
    </ul>
    
    <div>
        <div class="box span12">
            <div class="box-header well" data-original-title>
					<h2><i class="icon-user"></i></h2>
					<div class="box-icon">
						<a href="#" class="btn btn-setting btn-round"><i class="icon-cog"></i></a>
						<a href="#" class="btn btn-minimize btn-round"><i class="icon-chevron-up"></i></a>
					</div>
			</div>
            
            <div class="box-content">
                <div class="row-fluid">
                    <div class="span2">
                        <div id="DataTables_Table_0_wrapper" class="dataTables_length">
                            <label>
                                <select size="1" name="page_size" id="page_size">
                                    <option value="10" selected="selected">10</option>
                                    <option value="20">20</option>
                                    <option value="30">30</option>
                                    <option value="50">50</option>
                                </select>
                                 每页数量
                            </label>
                        </div>
                    </div>
					
					<div class="span3">
					<div class="btn-toobar">
						<div class="btn-group" style="display: inline-block">
							<a class="btn btn-success disabled" href="/system/alerts/physical_device/">物理设备</a>
						</div>
						<div class="btn-group" style="display: inline-block">
							<a class="btn btn-primary" href="/system/alerts/xenserver/">XenServer</a>
							<!--
							<a class="btn btn-primary" href="/system/alerts/libvirt/">Libvirt</a>
							-->
						</div>
						<!--
						<div class="btn-group" style="display: inline-block">
							<a class="btn btn-info" href="/system/alerts/cloudstack/">CloudStack</a>
							<a class="btn btn-info" href="/system/alerts/openstack/">OpenStack</a>
						</div>
						-->
					</div>
					</div>
					<div class="span1" style="display: inline-block;">
						+ <span class="label label-warning" id="alert_counter">0</span>
					</div>
                    
                    <div class="span4 pull-right"> <label>
                            搜索：
                            <input type="text">
                        </label> 
                    </div>
                    
                    <table class="table table-striped table-bordered bootstrap-datatable" id="">
						<tbody>
						<tr>
						<td id="physical-device-alert">
						{% for alert in alerts %}
							{% if alert['message']['return_code'] == 1 %}
								<div class="alert alert-info fade in">
									警告：
									{% if alert.get('created_time') %}
										{{ alert['created_time'] }} /
									{% end %}
									{{ alert['message']['host'] }} /
									{% if alert['message']['service'] %}
										{{ alert['message']['service'] }} /
									{% end %}
									{{ alert['message']['output'] }}
								</div>
							{% elif alert['message']['return_code'] == 2 %}
								<div class="alert alert-error fade in">
									严重：
									{% if alert.get('created_time') %}
										{{ alert['created_time'] }} /
									{% end %}
									{{ alert['message']['host'] }} /
									{% if alert['message']['service'] %}
										{{ alert['message']['service'] }} /
									{% end %}
									{{ alert['message']['output'] }}
								</div>
							{% elif alert['message']['return_code'] == 3 %}
								<div class="alert alert-block fade in">
									未知：
									{% if alert.get('created_time') %}
										{{ alert['created_time'] }} /
									{% end %}
									{{ alert['message']['host'] }} /
									{% if alert['message']['service'] %}
										{{ alert['message']['service'] }} /
									{% end %}
									{{ alert['message']['output'] }}
								</div>
							{% end %}
						{% end %}
						</td>
						</tr>
						</tbody>
					</table>
                </div>
            </div>
        </div>
    </div>
</div>
{% end %}